<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Ansible Encyclopedia · Architect's Toolkit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color-scheme: dark;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background:
        radial-gradient(circle at top, #111827, #020617 60%),
        radial-gradient(circle at bottom, #000000, #020617 70%);
      color: #e5e7eb;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    .shell {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      box-sizing: border-box;
    }

    .card {
      width: 100%;
      max-width: 1150px;
      background: rgba(15, 23, 42, 0.94);
      border-radius: 18px;
      padding: 1.5rem 1.75rem 1.75rem;
      box-shadow:
        0 22px 60px rgba(0, 0, 0, 0.85),
        0 0 0 1px rgba(148, 163, 184, 0.35);
      border: 1px solid rgba(148, 163, 184, 0.45);
      display: flex;
      flex-direction: column;
      gap: 1rem;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(59, 130, 246, 0.18), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(236, 72, 153, 0.16), transparent 55%),
        radial-gradient(circle at 50% 100%, rgba(16, 185, 129, 0.11), transparent 55%);
      opacity: 0.95;
      pointer-events: none;
      mix-blend-mode: screen;
    }

    .card-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      gap: 0.8rem;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.25rem;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
      min-width: 0;
    }

    .title-row {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      min-width: 0;
    }

    h1.page-title {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
      letter-spacing: 0.01em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    h1.page-title[contenteditable="true"] {
      cursor: text;
    }

    .page-title-hint {
      font-size: 0.76rem;
      color: #9ca3af;
      margin: 0;
    }

    .pill {
      border-radius: 999px;
      border: 1px solid rgba(248, 250, 252, 0.9);
      padding: 0.18rem 0.6rem;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.13em;
      color: #e5e7eb;
      background: rgba(15, 23, 42, 0.95);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .pill-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.3);
    }

    .tagline {
      margin: 0.1rem 0 0;
      font-size: 0.86rem;
      color: #d1d5db;
      max-width: 720px;
    }

    .meta {
      font-size: 0.76rem;
      color: #9ca3af;
      display: flex;
      flex-wrap: wrap;
      gap: 0.55rem;
      margin-top: 0.1rem;
    }

    .meta span {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    .meta-dot {
      width: 4px;
      height: 4px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.9);
    }

    .main-menu-btn {
      border-radius: 999px;
      border: 1px solid #1f2937;
      padding: 0.4rem 0.95rem;
      font-size: 0.8rem;
      background: #020617;
      color: #9ca3af;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      transition:
        background 0.12s ease,
        border-color 0.12s ease,
        color 0.12s ease,
        transform 0.06s ease;
      white-space: nowrap;
    }

    .main-menu-btn:hover {
      background: #111827;
      border-color: #2563eb;
      color: #e5e7eb;
      transform: translateY(-1px);
    }

    .workspace {
      margin-top: 0.3rem;
      border-radius: 1rem;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      min-height: 520px;
      background: radial-gradient(circle at top left, rgba(37, 99, 235, 0.14), transparent 55%);
      overflow: hidden;
      display: flex;
      align-items: stretch;
      justify-content: stretch;
    }

    .ans-layout {
      display: flex;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
    }

    .ans-nav {
      width: 245px;
      min-width: 220px;
      max-width: 260px;
      border-right: 1px solid rgba(148, 163, 184, 0.4);
      padding: 1rem;
      box-sizing: border-box;
      background: linear-gradient(180deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.82));
      backdrop-filter: blur(18px);
      overflow-y: auto;
      font-size: 0.83rem;
    }

    .ans-nav h2 {
      margin: 0 0 0.35rem 0;
      font-size: 1rem;
      font-weight: 600;
    }

    .ans-nav p {
      margin: 0 0 0.75rem 0;
      font-size: 0.78rem;
      color: #9ca3af;
    }

    .ans-nav-section-label {
      margin-top: 0.7rem;
      margin-bottom: 0.25rem;
      font-size: 0.72rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #6b7280;
    }

    .ans-nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
    }

    .ans-nav li {
      margin: 0;
    }

    .ans-nav a {
      color: #cbd5f5;
      text-decoration: none;
      display: block;
      padding: 0.22rem 0.4rem;
      border-radius: 999px;
      transition:
        background 0.12s ease,
        color 0.12s ease,
        transform 0.04s ease;
    }

    .ans-nav a:hover {
      background: rgba(37, 99, 235, 0.25);
      color: #eff6ff;
      transform: translateX(1px);
    }

    .ans-content {
      flex: 1;
      padding: 1rem 1.25rem 1.1rem;
      box-sizing: border-box;
      overflow-y: auto;
      font-size: 0.85rem;
    }

    .ans-section {
      margin-bottom: 1.5rem;
      padding-bottom: 1.1rem;
      border-bottom: 1px dashed rgba(148, 163, 184, 0.45);
    }

    .ans-section:last-of-type {
      border-bottom: none;
      margin-bottom: 0;
      padding-bottom: 0.4rem;
    }

    .ans-section-header {
      display: flex;
      align-items: baseline;
      gap: 0.45rem;
      margin-bottom: 0.3rem;
    }

    .ans-section-header h2 {
      margin: 0;
      font-size: 1.02rem;
      font-weight: 600;
    }

    .ans-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.05rem 0.4rem;
      font-size: 0.65rem;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.75);
      color: #bfdbfe;
      background: rgba(15, 23, 42, 0.96);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      white-space: nowrap;
    }

    .ans-tagline {
      margin: 0.3rem 0 0.4rem;
      color: #9ca3af;
      font-size: 0.82rem;
    }

    .ans-columns {
      display: grid;
      grid-template-columns: minmax(0, 1.15fr) minmax(0, 1fr);
      gap: 1rem;
    }

    .ans-list {
      margin: 0.35rem 0 0.2rem;
      padding-left: 1.1rem;
      font-size: 0.82rem;
    }

    .ans-list li {
      margin-bottom: 0.18rem;
    }

    .ans-code {
      margin-top: 0.4rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.78rem;
      background: #020617;
      border-radius: 0.6rem;
      padding: 0.55rem 0.65rem;
      border: 1px solid rgba(31, 41, 55, 0.9);
      overflow-x: auto;
      line-height: 1.35;
    }

    .ans-code code {
      white-space: pre;
    }

    .ans-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.45rem;
      font-size: 0.8rem;
      border-radius: 0.7rem;
      overflow: hidden;
    }

    .ans-table thead {
      background: rgba(15, 23, 42, 0.98);
    }

    .ans-table th,
    .ans-table td {
      border: 1px solid rgba(55, 65, 81, 0.95);
      padding: 0.3rem 0.45rem;
      text-align: left;
      vertical-align: top;
    }

    .ans-table th {
      font-weight: 600;
      color: #e5e7eb;
    }

    .ans-table td {
      color: #d1d5db;
    }

    .ans-note {
      margin-top: 0.4rem;
      font-size: 0.78rem;
      color: #9ca3af;
    }

    .ans-chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      margin-top: 0.3rem;
    }

    .ans-chip {
      font-size: 0.7rem;
      border-radius: 999px;
      padding: 0.15rem 0.4rem;
      border: 1px solid rgba(148, 163, 184, 0.85);
      background: rgba(15, 23, 42, 0.95);
      color: #e5e7eb;
      white-space: nowrap;
    }

    .ans-kv {
      margin: 0.4rem 0;
      display: grid;
      grid-template-columns: max-content minmax(0, 1fr);
      gap: 0.15rem 0.6rem;
      font-size: 0.8rem;
    }

    .ans-kv dt {
      font-weight: 600;
      color: #e5e7eb;
      align-self: center;
    }

    .ans-kv dd {
      margin: 0;
      color: #9ca3af;
    }

    .footnote {
      margin-top: 0.4rem;
      font-size: 0.75rem;
      color: #9ca3af;
      text-align: right;
    }

    input,
    select,
    textarea {
      font-family: inherit;
    }

    @media (max-width: 950px) {
      .ans-layout {
        flex-direction: column;
      }

      .ans-nav {
        width: 100%;
        max-width: 100%;
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.4);
      }

      .ans-columns {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 720px) {
      .shell {
        padding: 1.25rem;
      }

      .card {
        padding: 1.1rem 1.1rem 1.3rem;
      }

      header {
        flex-direction: column;
        align-items: flex-start;
      }

      h1.page-title {
        font-size: 1.35rem;
      }

      .footnote {
        text-align: left;
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="card">
      <div class="card-inner">
        <header>
          <div class="title-block">
            <div class="title-row">
              <h1 class="page-title" contenteditable="true" spellcheck="false">
                Ansible Encyclopedia · Architect's Toolkit
              </h1>
              <div class="pill">
                <span class="pill-dot"></span>
                <span>Automation · Configuration · Day-2 Ops</span>
              </div>
            </div>
            <p class="page-title-hint">
              Rename this page to match a specific program (e.g. “Courts · Ansible Ops & Hardening”).
            </p>
            <p class="tagline">
              Use this as the source of truth for how Ansible is used across environments, clouds, and data classifications.
            </p>
            <div class="meta">
              <span><span class="meta-dot"></span> Terraform owns infra · Ansible owns OS & apps</span>
              <span><span class="meta-dot"></span> Pattern-driven, not snowflake playbooks</span>
              <span><span class="meta-dot"></span> Exportable JSON/YAML manifests for CI/CD</span>
            </div>
          </div>

          <button class="main-menu-btn" type="button" onclick="window.location.href='index.html'">
            ← Main menu
          </button>
        </header>

        <section class="workspace">
          <div class="ans-layout">
            <nav class="ans-nav">
              <h2>Ansible Encyclopedia</h2>
              <p>Inventory, playbooks, roles, and exports driven by data-classification.</p>

              <div class="ans-nav-section-label">Core Concepts</div>
              <ul>
                <li><a href="#ans-model">1. What Ansible Owns</a></li>
                <li><a href="#ans-inventory">2. Inventory & Groups</a></li>
                <li><a href="#ans-playbooks">3. Playbooks & Roles</a></li>
                <li><a href="#ans-pipelines">4. CI/CD & Workflows</a></li>
              </ul>

              <div class="ans-nav-section-label">Security & Compliance</div>
              <ul>
                <li><a href="#ans-guardrails">5. Guardrails & STIG/CIS</a></li>
                <li><a href="#ans-secrets">6. Vault & Secret Handling</a></li>
              </ul>

              <div class="ans-nav-section-label">Cloud / Platform Views</div>
              <ul>
                <li><a href="#ans-cloud">7. Cloud-Aware Patterns</a></li>
              </ul>

              <div class="ans-nav-section-label">Reference</div>
              <ul>
                <li><a href="#ans-dictionary">8. Command &amp; Module Dictionary</a></li>
                <li><a href="#ans-exports">9. Architect Export Helper</a></li>
              </ul>
            </nav>

            <main class="ans-content">
              <!-- 1. MODEL -->
              <section id="ans-model" class="ans-section">
                <div class="ans-section-header">
                  <h2>1. What Ansible Owns vs. Terraform</h2>
                  <span class="ans-badge">Model</span>
                </div>
                <p class="ans-tagline">
                  Terraform: <strong>cloud resources & accounts.</strong> Ansible: <strong>hosts, OS, apps, and day-2 operations</strong> across your fleets.
                </p>

                <div class="ans-columns">
                  <div>
                    <h3 style="margin:0 0 0.25rem;">1.1 Ansible Sweet Spot</h3>
                    <ul class="ans-list">
                      <li>OS baseline (packages, services, users, sysctl).</li>
                      <li>Application deployment & configuration (web, app, DB, middleware).</li>
                      <li>Compliance & drift correction (STIG/CIS implementations).</li>
                      <li>Emergency changes during incidents (with approvals).</li>
                    </ul>
                    <p class="ans-note">
                      The single source of truth for <em>what</em> hosts should look like comes from your
                      <code>data-classification.html</code> and <code>single-source-of-truth.html</code> tools.
                    </p>
                  </div>
                  <div>
                    <h3 style="margin:0 0 0.25rem;">1.2 Terraform vs. Ansible</h3>
                    <table class="ans-table">
                      <thead>
                        <tr>
                          <th>Area</th>
                          <th>Terraform</th>
                          <th>Ansible</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>Scope</td>
                          <td>Cloud infra, accounts, networks, storage.</td>
                          <td>OS, files, services, agents, apps.</td>
                        </tr>
                        <tr>
                          <td>Lifecycle</td>
                          <td>Long-lived state, declarative.</td>
                          <td>Desired config via idempotent tasks.</td>
                        </tr>
                        <tr>
                          <td>When to use</td>
                          <td>Landing zones, VPCs, databases, queues.</td>
                          <td>Hardening, deployment, patches, ops.</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </section>

              <!-- 2. INVENTORY -->
              <section id="ans-inventory" class="ans-section">
                <div class="ans-section-header">
                  <h2>2. Inventory & Groups</h2>
                  <span class="ans-badge">Scope</span>
                </div>
                <p class="ans-tagline">
                  Inventory maps hosts to <strong>groups</strong> (web, db, batch) and <strong>environments</strong> (dev, prod)
                  — driven by tags and Terraform outputs.
                </p>

                <div class="ans-columns">
                  <div>
                    <h3 style="margin:0 0 0.2rem;">2.1 Static Inventory Example</h3>
                    <div class="ans-code">
                      <code>[web_cjis_prod]
host1.example.com
host2.example.com

[web_cjis_prod:vars]
env=prod
data_classification=CJIS
ansible_host_key_checking=true</code>
                    </div>
                    <p class="ans-note">
                      Even static files should carry <strong>classification tags</strong> and environment metadata.
                    </p>
                  </div>
                  <div>
                    <h3 style="margin:0 0 0.2rem;">2.2 Dynamic Inventory Pattern</h3>
                    <ul class="ans-list">
                      <li>Use cloud tags/labels (<code>role</code>, <code>env</code>, <code>data_classification</code>).</li>
                      <li>Dynamic inventory plugin builds groups (e.g. “all prod web in us-east-1”).</li>
                      <li>Terraform outputs feed inventory discovery.</li>
                    </ul>
                    <div class="ans-note">
                      Export manifests from <code>data-classification.html</code> and reuse tags here so your
                      inventory <em>is</em> the classification.
                    </div>
                  </div>
                </div>
              </section>

              <!-- 3. PLAYBOOKS -->
              <section id="ans-playbooks" class="ans-section">
                <div class="ans-section-header">
                  <h2>3. Playbooks & Roles</h2>
                  <span class="ans-badge">Execution</span>
                </div>

                <div class="ans-columns">
                  <div>
                    <h3 style="margin:0 0 0.2rem;">3.1 Basic Playbook</h3>
                    <div class="ans-code">
                      <code>---
- name: Harden and configure web servers
  hosts: web_cjis_prod
  become: true

  roles:
    - cis_hardening
    - web_app

  vars:
    data_classification: "CJIS"
    rto_hours: 1
    rpo_minutes: 15</code>
                    </div>
                    <p class="ans-note">
                      Carry <code>data_classification</code>, <code>rto_hours</code>, <code>rpo_minutes</code> in vars to keep
                      the link to your classification model.
                    </p>
                  </div>
                  <div>
                    <h3 style="margin:0 0 0.2rem;">3.2 Roles & Structure</h3>
                    <ul class="ans-list">
                      <li><code>cis_hardening</code> – baseline OS hardening.</li>
                      <li><code>logging_agent</code> – forward logs to SIEM.</li>
                      <li><code>web_app</code> – app deployment and config.</li>
                    </ul>
                    <p class="ans-note">
                      Keep roles small and composable; build <strong>patterns per classification</strong> (P1/P2/P3).
                    </p>
                  </div>
                </div>
              </section>

              <!-- 4. PIPELINES -->
              <section id="ans-pipelines" class="ans-section">
                <div class="ans-section-header">
                  <h2>4. CI/CD & Run Pipelines</h2>
                  <span class="ans-badge">Workflow</span>
                </div>
                <p class="ans-tagline">
                  Jobs should be driven by <strong>manifests</strong>, not hand-typed ad-hoc commands.
                </p>

                <div class="ans-code">
                  <code># Example pipeline stages
ansible-lint playbooks/
ansible-playbook --syntax-check site.yml
ansible-playbook site.yml --limit "env_prod:&data_classification_cjis"</code>
                </div>

                <p class="ans-note">
                  Use the export helper below to generate JSON/YAML manifests that your CI pipeline can consume
                  (which playbooks to run, which groups to target, which classifications apply).
                </p>
              </section>

              <!-- 5. GUARDRAILS -->
              <section id="ans-guardrails" class="ans-section">
                <div class="ans-section-header">
                  <h2>5. Guardrails, STIG & CIS</h2>
                  <span class="ans-badge">Controls</span>
                </div>
                <p class="ans-tagline">
                  Map regulatory / framework requirements onto concrete Ansible roles and tasks.
                </p>

                <div class="ans-columns">
                  <div>
                    <ul class="ans-list">
                      <li>Baseline roles: <code>cis_linux_level1</code>, <code>cis_windows</code>, <code>cjis_controls</code>.</li>
                      <li>Control mapping: each task references a control ID (e.g. <code>CIS-2.1.1</code>).</li>
                      <li>Export the mapping into <code>single-source-of-truth.html</code> as object metadata.</li>
                    </ul>
                  </div>
                  <div>
                    <p class="ans-note">
                      You can build a JSON manifest of “control → role → task” and keep it next to your roles;
                      this page is where you describe the pattern.
                    </p>
                  </div>
                </div>
              </section>

              <!-- 6. SECRETS -->
              <section id="ans-secrets" class="ans-section">
                <div class="ans-section-header">
                  <h2>6. Vault & Secrets</h2>
                  <span class="ans-badge">Secrets</span>
                </div>

                <div class="ans-columns">
                  <div>
                    <div class="ans-code">
                      <code># Encrypt file
ansible-vault encrypt group_vars/prod.yml

# Edit
ansible-vault edit group_vars/prod.yml

# Run playbook
ansible-playbook site.yml --ask-vault-pass</code>
                    </div>
                  </div>
                  <div>
                    <ul class="ans-list">
                      <li>Use Vault IDs and KMS/HSM where possible.</li>
                      <li>No secrets committed in cleartext anywhere.</li>
                      <li>Align secret stores with Terraform (shared enterprise store).</li>
                    </ul>
                  </div>
                </div>
              </section>

              <!-- 7. CLOUD AWARE -->
              <section id="ans-cloud" class="ans-section">
                <div class="ans-section-header">
                  <h2>7. Cloud-Aware Patterns</h2>
                  <span class="ans-badge">Cloud</span>
                </div>
                <p class="ans-tagline">
                  Same playbook concepts, different providers. Tags and labels bind everything together.
                </p>

                <div class="ans-columns">
                  <div>
                    <h3 style="margin:0 0 0.2rem;">7.1 Tags / Labels</h3>
                    <ul class="ans-list">
                      <li>AWS: <code>Tags</code> (key=value).</li>
                      <li>GCP: <code>labels</code>, <code>metadata</code>.</li>
                      <li>Azure: <code>tags</code> on resources.</li>
                    </ul>
                    <p class="ans-note">
                      The export helper below lets you define tag sets once and reuse them for inventory
                      and Terraform.
                    </p>
                  </div>
                  <div>
                    <h3 style="margin:0 0 0.2rem;">7.2 Common Tag Keys</h3>
                    <ul class="ans-list">
                      <li><code>env</code> (dev/test/prod).</li>
                      <li><code>data_classification</code> (Public/Internal/CJIS/PHI).</li>
                      <li><code>system</code>, <code>owner</code>, <code>cost_center</code>.</li>
                    </ul>
                  </div>
                </div>
              </section>

              <!-- 8. DICTIONARY -->
              <section id="ans-dictionary" class="ans-section">
                <div class="ans-section-header">
                  <h2>8. Command & Module Dictionary</h2>
                  <span class="ans-badge">Dictionary</span>
                </div>
                <p class="ans-tagline">
                  A quick mapping of common commands and modules to what they are for.
                </p>

                <table class="ans-table">
                  <thead>
                    <tr>
                      <th>Command / Module</th>
                      <th>Category</th>
                      <th>Notes</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><code>ansible</code></td>
                      <td>Ad-hoc</td>
                      <td>One-off commands; governance should limit these in prod.</td>
                    </tr>
                    <tr>
                      <td><code>ansible-playbook</code></td>
                      <td>Execution</td>
                      <td>Runs playbooks; pipeline entrypoint.</td>
                    </tr>
                    <tr>
                      <td><code>ansible-galaxy</code></td>
                      <td>Content</td>
                      <td>Install roles/collections; pin versions.</td>
                    </tr>
                    <tr>
                      <td><code>ansible.builtin.package</code></td>
                      <td>OS</td>
                      <td>Install packages; idempotent wrapper over apt/yum/etc.</td>
                    </tr>
                    <tr>
                      <td><code>ansible.builtin.service</code></td>
                      <td>OS</td>
                      <td>Start/stop/enable services; core for app lifecycles.</td>
                    </tr>
                    <tr>
                      <td><code>ansible.builtin.user</code></td>
                      <td>OS</td>
                      <td>Manage local users; use for least-privilege accounts.</td>
                    </tr>
                    <tr>
                      <td><code>amazon.aws.ec2_instance</code></td>
                      <td>Cloud</td>
                      <td>VM lifecycle if you occasionally manage compute directly.</td>
                    </tr>
                    <tr>
                      <td><code>azure.azcollection.azure_rm_virtualmachine</code></td>
                      <td>Cloud</td>
                      <td>Same as above, Azure VM lifecycle.</td>
                    </tr>
                  </tbody>
                </table>

                <p class="ans-note">
                  Extend this table whenever engineers ask “what module are we supposed to use for X?”.
                </p>
              </section>

              <!-- 9. ARCHITECT EXPORT HELPER -->
              <section id="ans-exports" class="ans-section">
                <div class="ans-section-header">
                  <h2>9. Architect Export Helper (Ansible)</h2>
                  <span class="ans-badge">Exports</span>
                </div>
                <p class="ans-tagline">
                  Turn a slice of your design (classification + environment + tag set) into
                  <strong>JSON / YAML / inventory snippets</strong> you can commit and wire into CI/CD.
                </p>

                <div class="ans-columns">
                  <div>
                    <h3 style="margin:0 0 0.25rem;">9.1 Input – Describe the slice</h3>

                    <dl class="ans-kv">
                      <dt>Classification tier</dt>
                      <dd>
                        <div style="display:flex;flex-direction:column;gap:0.2rem;">
                          <select
                            id="ansExpClassificationPreset"
                            style="width:100%;padding:0.25rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.95);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;"
                          >
                            <option value="">Select tier…</option>
                            <option value="Public">Public</option>
                            <option value="Internal">Internal</option>
                            <option value="PII">PII</option>
                            <option value="PHI">PHI</option>
                            <option value="CJIS">CJIS</option>
                            <option value="FISA">FISA</option>
                            <option value="Secret">Secret</option>
                            <option value="Top Secret">Top Secret</option>
                          </select>
                          <input
                            id="ansExpClassificationCustom"
                            type="text"
                            placeholder="Custom (optional) – overrides dropdown when filled"
                            style="width:100%;padding:0.2rem 0.4rem;border-radius:0.4rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#9ca3af;font-size:0.78rem;box-sizing:border-box;"
                          />
                        </div>
                      </dd>

                      <dt>Environment</dt>
                      <dd>
                        <div style="display:flex;flex-direction:column;gap:0.2rem;">
                          <select
                            id="ansExpEnvironmentPreset"
                            style="width:100%;padding:0.25rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.95);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;"
                          >
                            <option value="">Select environment…</option>
                            <option value="dev">dev</option>
                            <option value="test">test</option>
                            <option value="qa">qa</option>
                            <option value="stage">stage</option>
                            <option value="preprod">preprod</option>
                            <option value="prod">prod</option>
                            <option value="dr">dr</option>
                            <option value="sandbox">sandbox</option>
                            <option value="mgmt">mgmt</option>
                          </select>
                          <input
                            id="ansExpEnvironmentCustom"
                            type="text"
                            placeholder="Custom env (optional) – overrides dropdown when filled"
                            style="width:100%;padding:0.2rem 0.4rem;border-radius:0.4rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#9ca3af;font-size:0.78rem;box-sizing:border-box;"
                          />
                        </div>
                      </dd>

                      <dt>Cloud / platform target</dt>
                      <dd>
                        <select
                          id="ansExpCloudTarget"
                          style="width:100%;padding:0.25rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.9);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;"
                        >
                          <option value="">Select platform…</option>
                          <option value="AWS">AWS</option>
                          <option value="Azure">Azure</option>
                          <option value="Google Cloud">Google Cloud</option>
                          <option value="Multi-cloud">Multi-cloud</option>
                          <option value="On-prem / VMware">On-prem / VMware</option>
                          <option value="Other / Sovereign">Other / Sovereign</option>
                        </select>
                      </dd>

                      <dt>Inventory group pattern</dt>
                      <dd>
                        <div style="display:flex;flex-direction:column;gap:0.2rem;">
                          <select
                            id="ansExpInventoryPreset"
                            style="width:100%;padding:0.25rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.95);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;"
                          >
                            <option value="">Select pattern…</option>
                            <option value="web">web</option>
                            <option value="app">app</option>
                            <option value="db">db</option>
                            <option value="batch">batch</option>
                            <option value="infra">infra</option>
                            <option value="directory">directory</option>
                            <option value="messaging">messaging</option>
                            <option value="email">email</option>
                            <option value="identity">identity</option>
                          </select>
                          <input
                            id="ansExpInventoryCustom"
                            type="text"
                            placeholder="Full group name (e.g. web_cjis_prod) – overrides pattern when filled"
                            style="width:100%;padding:0.2rem 0.4rem;border-radius:0.4rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#9ca3af;font-size:0.78rem;box-sizing:border-box;"
                          />
                        </div>
                      </dd>

                      <dt>Fleet selector</dt>
                      <dd>
                        <div style="display:flex;flex-direction:column;gap:0.2rem;">
                          <select
                            id="ansExpFleetPreset"
                            style="width:100%;padding:0.25rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.95);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;"
                          >
                            <option value="">Select selector…</option>
                            <option value="ansible_os_family == 'Debian'">Debian-family Linux</option>
                            <option value="ansible_os_family == 'RedHat'">RedHat-family Linux</option>
                            <option value="ansible_os_family == 'Windows'">Windows servers</option>
                            <option value="tag:data_classification=CJIS">Tag: data_classification=CJIS</option>
                            <option value="tag:env=prod">Tag: env=prod</option>
                          </select>
                          <input
                            id="ansExpFleetCustom"
                            type="text"
                            placeholder="Custom selector (optional) – overrides dropdown when filled"
                            style="width:100%;padding:0.2rem 0.4rem;border-radius:0.4rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#9ca3af;font-size:0.78rem;box-sizing:border-box;"
                          />
                        </div>
                      </dd>

                      <dt>Roles to apply</dt>
                      <dd>
                        <div style="display:flex;flex-direction:column;gap:0.25rem;">
                          <div style="display:flex;flex-wrap:wrap;gap:0.5rem;font-size:0.78rem;">
                            <label style="display:flex;align-items:center;gap:0.2rem;cursor:pointer;">
                              <input type="checkbox" class="ansRolePreset" value="cis_hardening" /> cis_hardening
                            </label>
                            <label style="display:flex;align-items:center;gap:0.2rem;cursor:pointer;">
                              <input type="checkbox" class="ansRolePreset" value="logging_agent" /> logging_agent
                            </label>
                            <label style="display:flex;align-items:center;gap:0.2rem;cursor:pointer;">
                              <input type="checkbox" class="ansRolePreset" value="web_app" /> web_app
                            </label>
                            <label style="display:flex;align-items:center;gap:0.2rem;cursor:pointer;">
                              <input type="checkbox" class="ansRolePreset" value="db_server" /> db_server
                            </label>
                            <label style="display:flex;align-items:center;gap:0.2rem;cursor:pointer;">
                              <input type="checkbox" class="ansRolePreset" value="monitoring_agent" /> monitoring_agent
                            </label>
                          </div>
                          <input
                            id="ansExpRolesCustom"
                            type="text"
                            placeholder="Extra roles (comma-separated) – merged with above"
                            style="width:100%;padding:0.2rem 0.4rem;border-radius:0.4rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#9ca3af;font-size:0.78rem;box-sizing:border-box;"
                          />
                        </div>
                      </dd>

                      <dt>Tag namespace / style</dt>
                      <dd>
                        <div style="display:flex;flex-direction:column;gap:0.2rem;">
                          <select
                            id="ansExpTagNamespacePreset"
                            style="width:100%;padding:0.25rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.95);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;"
                          >
                            <option value="">Select style…</option>
                            <option value="AWS tags">AWS tags (key=value)</option>
                            <option value="GCP labels">GCP labels</option>
                            <option value="Azure tags">Azure tags</option>
                            <option value="Multi-provider tags/labels">Multi-provider tags/labels</option>
                          </select>
                          <input
                            id="ansExpTagNamespaceCustom"
                            type="text"
                            placeholder="Custom namespace description (optional) – overrides dropdown when filled"
                            style="width:100%;padding:0.2rem 0.4rem;border-radius:0.4rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#9ca3af;font-size:0.78rem;box-sizing:border-box;"
                          />
                        </div>
                      </dd>

                      <dt>Tag set (key=value, one per line)</dt>
                      <dd>
                        <textarea
                          id="ansExpTags"
                          placeholder="env=prod&#10;data_classification=CJIS&#10;system=court_case_mgmt"
                          style="width:100%;min-height:80px;padding:0.3rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.9);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;resize:vertical;"
                        ></textarea>
                      </dd>

                      <dt>Notes / guarantees</dt>
                      <dd>
                        <textarea
                          id="ansExpNotes"
                          placeholder="e.g. Hardware keys enforced; logs to central SIEM; RTO 1h / RPO 15m from data-classification.html."
                          style="width:100%;min-height:70px;padding:0.3rem 0.4rem;border-radius:0.45rem;border:1px solid rgba(75,85,99,0.9);background:#020617;color:#e5e7eb;font-size:0.8rem;box-sizing:border-box;resize:vertical;"
                        ></textarea>
                      </dd>
                    </dl>

                    <p class="ans-note">
                      Copy classification name, residency, RTO/RPO from <code>data-classification.html</code> for the
                      dataset you’re modeling here.
                    </p>
                  </div>

                  <div>
                    <h3 style="margin:0 0 0.25rem;">9.2 Output – JSON / YAML / Inventory</h3>
                    <div class="ans-chip-row">
                      <span class="ans-chip">JSON manifest</span>
                      <span class="ans-chip">YAML (human-friendly)</span>
                      <span class="ans-chip">Ansible inventory + vars</span>
                    </div>

                    <div style="margin-top:0.6rem;">
                      <div style="font-size:0.78rem;color:#d1d5db;margin-bottom:0.2rem;">Output format</div>
                      <div style="display:flex;flex-wrap:wrap;gap:0.45rem;font-size:0.78rem;">
                        <label style="display:inline-flex;align-items:center;gap:0.25rem;cursor:pointer;">
                          <input type="radio" name="ansExpFormat" value="json" checked /> JSON
                        </label>
                        <label style="display:inline-flex;align-items:center;gap:0.25rem;cursor:pointer;">
                          <input type="radio" name="ansExpFormat" value="yaml" /> YAML
                        </label>
                        <label style="display:inline-flex;align-items:center;gap:0.25rem;cursor:pointer;">
                          <input type="radio" name="ansExpFormat" value="inventory" /> Inventory + vars
                        </label>
                      </div>
                    </div>

                    <div style="margin-top:0.6rem;display:flex;flex-wrap:wrap;gap:0.4rem;">
                      <button
                        type="button"
                        onclick="window.ansExportGenerate()"
                        style="border-radius:999px;border:1px solid rgba(59,130,246,0.9);background:#1d4ed8;color:#e5e7eb;font-size:0.8rem;padding:0.3rem 0.9rem;cursor:pointer;"
                      >
                        Generate
                      </button>
                      <button
                        type="button"
                        onclick="window.ansExportCopy()"
                        style="border-radius:999px;border:1px solid rgba(148,163,184,0.9);background:#020617;color:#e5e7eb;font-size:0.8rem;padding:0.3rem 0.9rem;cursor:pointer;"
                      >
                        Copy to clipboard
                      </button>
                    </div>

                    <textarea
                      id="ansExportOutput"
                      readonly
                      placeholder="Generated export will appear here."
                      style="margin-top:0.6rem;width:100%;min-height:220px;padding:0.4rem 0.5rem;border-radius:0.6rem;border:1px solid rgba(55,65,81,0.95);background:#020617;color:#e5e7eb;font-size:0.78rem;box-sizing:border-box;resize:vertical;font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;"
                    ></textarea>

                    <p class="ans-note">
                      Store these files under something like <code>arch/ansible-manifests/</code> or
                      <code>iac/catalogs/</code> and treat them as part of the single source of truth.
                    </p>
                  </div>
                </div>
              </section>
            </main>
          </div>
        </section>

        <div class="footnote">
          Save this as <code>ansible.html</code> next to <code>index.html</code>.
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      function parseTags(raw) {
        if (!raw) return {};
        const lines = raw.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
        const out = {};
        for (const line of lines) {
          const idx = line.indexOf("=");
          if (idx === -1) {
            out[line] = "";
          } else {
            const k = line.slice(0, idx).trim();
            const v = line.slice(idx + 1).trim();
            if (k) out[k] = v;
          }
        }
        return out;
      }

      function getRadioFormat() {
        const nodes = document.querySelectorAll('input[name="ansExpFormat"]');
        for (const n of nodes) {
          if (n.checked) return n.value;
        }
        return "json";
      }

      function getPresetOrCustom(presetId, customId) {
        const presetEl = document.getElementById(presetId);
        const customEl = document.getElementById(customId);
        const customVal = (customEl && customEl.value.trim()) || "";
        if (customVal) return customVal;
        return (presetEl && presetEl.value.trim()) || "";
      }

      function getRoles() {
        const presets = Array.from(document.querySelectorAll(".ansRolePreset"))
          .filter(cb => cb.checked)
          .map(cb => cb.value.trim())
          .filter(Boolean);

        const customRaw = document.getElementById("ansExpRolesCustom").value.trim();
        const custom = customRaw
          ? customRaw.split(",").map(r => r.trim()).filter(Boolean)
          : [];

        const combined = [...presets, ...custom];
        // dedupe
        return Array.from(new Set(combined));
      }

      function buildManifest() {
        const classification = getPresetOrCustom("ansExpClassificationPreset", "ansExpClassificationCustom");
        const env = getPresetOrCustom("ansExpEnvironmentPreset", "ansExpEnvironmentCustom");
        const cloud = document.getElementById("ansExpCloudTarget").value.trim();
        const invGroup = getPresetOrCustom("ansExpInventoryPreset", "ansExpInventoryCustom");
        const fleetSelector = getPresetOrCustom("ansExpFleetPreset", "ansExpFleetCustom");
        const tagNamespace = getPresetOrCustom("ansExpTagNamespacePreset", "ansExpTagNamespaceCustom");

        const tagsRaw = document.getElementById("ansExpTags").value.trim();
        const notes = document.getElementById("ansExpNotes").value.trim();

        const roles = getRoles();

        return {
          kind: "ansible_export_manifest",
          version: "v1",
          metadata: {
            classification_name: classification,
            environment: env,
            cloud_target: cloud,
            tag_namespace: tagNamespace,
            generated_at: new Date().toISOString()
          },
          ansible: {
            primary_inventory_group: invGroup,
            fleet_selector: fleetSelector,
            roles: roles
          },
          tags: parseTags(tagsRaw),
          notes: notes
        };
      }

      function toYaml(obj, indent) {
        indent = indent || "";
        if (obj === null || obj === undefined) return "null";
        if (typeof obj === "string" || typeof obj === "number" || typeof obj === "boolean") {
          if (typeof obj === "string" && /[:#\-?{},[\]&*!|>'"%@`]/.test(obj)) {
            return JSON.stringify(obj);
          }
          return String(obj);
        }
        if (Array.isArray(obj)) {
          if (obj.length === 0) return "[]";
          return obj
            .map(v => indent + "- " + toYaml(v, indent + "  ").replace(/^\s+/, ""))
            .join("\n");
        }
        const keys = Object.keys(obj);
        if (keys.length === 0) return "{}";
        return keys
          .map(k => {
            const v = obj[k];
            if (v === null || v === undefined) return indent + k + ": null";
            if (typeof v === "object") {
              const nested = toYaml(v, indent + "  ");
              if (nested.indexOf("\n") === -1) {
                return indent + k + ": " + nested;
              }
              return indent + k + ":\n" + nested;
            }
            return indent + k + ": " + toYaml(v, indent + "  ");
          })
          .join("\n");
      }

      function toInventory(manifest) {
        const group = manifest.ansible.primary_inventory_group || "CLASSIFIED_GROUP";
        const roles = manifest.ansible.roles || [];
        const tags = manifest.tags || {};
        const lines = [];

        lines.push("[" + group + "]");
        lines.push("# host1.example.com");
        lines.push("# host2.example.com");
        lines.push("");
        lines.push("[" + group + ":vars]");
        lines.push("classification_name=" + (manifest.metadata.classification_name || ""));
        lines.push("environment=" + (manifest.metadata.environment || ""));
        lines.push("cloud_target=" + (manifest.metadata.cloud_target || ""));
        if (manifest.metadata.tag_namespace) {
          lines.push("tag_namespace=" + JSON.stringify(manifest.metadata.tag_namespace));
        }
        if (roles.length) {
          lines.push("ansible_role_set=" + roles.join(","));
        }
        for (const k of Object.keys(tags)) {
          lines.push(k + "=" + tags[k]);
        }
        if (manifest.notes) {
          lines.push("notes=" + JSON.stringify(manifest.notes));
        }
        return lines.join("\n");
      }

      window.ansExportGenerate = function () {
        const outEl = document.getElementById("ansExportOutput");
        if (!outEl) return;
        const manifest = buildManifest();
        const fmt = getRadioFormat();
        let text = "";

        if (fmt === "json") {
          text = JSON.stringify(manifest, null, 2);
        } else if (fmt === "yaml") {
          text = toYaml(manifest);
        } else if (fmt === "inventory") {
          text = toInventory(manifest);
        } else {
          text = JSON.stringify(manifest, null, 2);
        }

        outEl.value = text;
      };

      window.ansExportCopy = function () {
        const outEl = document.getElementById("ansExportOutput");
        if (!outEl || !outEl.value) return;
        try {
          outEl.select();
          document.execCommand("copy");
        } catch (e) {
          if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(outEl.value);
          }
        }
      };
    })();
  </script>
</body>
</html>
