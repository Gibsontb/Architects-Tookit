<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Terraform Encyclopedia · Architect's Toolkit</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color-scheme: dark light;
    }

    body {
      margin: 0;
      min-height: 100vh;
      background: radial-gradient(circle at top, #1a2735, #050608 60%);
      color: #f5f5f5;
      display: flex;
      align-items: stretch;
      justify-content: center;
    }

    .shell {
      flex: 1;
      display: flex;
      align-items: stretch;
      justify-content: center;
      padding: 2rem;
      box-sizing: border-box;
    }

    .card {
      width: 100%;
      max-width: 1100px;
      background: rgba(0, 0, 0, 0.55);
      border-radius: 16px;
      padding: 1.25rem 1.5rem 1.5rem;
      box-shadow: 0 18px 45px rgba(0, 0, 0, 0.65);
      border: 1px solid rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(14px);
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 0.25rem;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
      min-width: 0;
    }

    h1.page-title {
      margin: 0;
      font-size: 1.4rem;
      font-weight: 600;
      outline: none;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    h1.page-title[contenteditable="true"] {
      cursor: text;
    }

    .page-title-hint {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .main-menu-btn {
      border-radius: 999px;
      border: 1px solid #1f2937;
      padding: 0.35rem 0.95rem;
      font-size: 0.78rem;
      background: #020617;
      color: #9ca3af;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      transition:
        background 0.12s ease,
        border-color 0.12s ease,
        color 0.12s ease,
        transform 0.05s ease;
      white-space: nowrap;
    }

    .main-menu-btn:hover {
      background: #111827;
      border-color: #2563eb;
      color: #e5e7eb;
      transform: translateY(-1px);
    }

    .workspace {
      flex: 1;
      margin-top: 0.25rem;
      border-radius: 0.9rem;
      border: 1px dashed rgba(148, 163, 184, 0.6);
      padding: 0;
      font-size: 0.9rem;
      color: #e5e7eb;
      display: flex;
      align-items: stretch;
      justify-content: stretch;
      min-height: 480px;
      box-sizing: border-box;
      background: radial-gradient(circle at top left, rgba(37,99,235,0.14), transparent 55%);
      overflow: hidden;
    }

    .footer-note {
      margin-top: 0.5rem;
      font-size: 0.78rem;
      color: #9ca3af;
      text-align: right;
    }

    /* Terraform encyclopedia layout */

    .tf-layout {
      display: flex;
      width: 100%;
      height: 100%;
      box-sizing: border-box;
    }

    .tf-nav {
      width: 230px;
      min-width: 200px;
      max-width: 260px;
      border-right: 1px solid rgba(148, 163, 184, 0.35);
      padding: 1rem;
      box-sizing: border-box;
      backdrop-filter: blur(18px);
      background: linear-gradient(180deg, rgba(15,23,42,0.7), rgba(15,23,42,0.35));
      overflow-y: auto;
    }

    .tf-nav h2 {
      margin: 0 0 0.4rem 0;
      font-size: 1rem;
      font-weight: 600;
    }

    .tf-nav p {
      margin: 0 0 0.75rem 0;
      font-size: 0.8rem;
      color: #9ca3af;
    }

    .tf-nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      font-size: 0.83rem;
    }

    .tf-nav li {
      margin: 0;
    }

    .tf-nav a {
      color: #cbd5f5;
      text-decoration: none;
      display: block;
      padding: 0.22rem 0.4rem;
      border-radius: 999px;
      transition: background 0.12s ease, color 0.12s ease, transform 0.04s ease;
    }

    .tf-nav a:hover {
      background: rgba(37, 99, 235, 0.25);
      color: #eff6ff;
      transform: translateX(1px);
    }

    .tf-nav-section-label {
      margin-top: 0.7rem;
      margin-bottom: 0.25rem;
      font-size: 0.72rem;
      letter-spacing: 0.04em;
      text-transform: uppercase;
      color: #6b7280;
    }

    .tf-content {
      flex: 1;
      padding: 1rem 1.25rem 1rem;
      box-sizing: border-box;
      overflow-y: auto;
    }

    .tf-content h2 {
      margin-top: 0;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .tf-section {
      margin-bottom: 1.6rem;
      padding-bottom: 1.1rem;
      border-bottom: 1px dashed rgba(148, 163, 184, 0.4);
    }

    .tf-section:last-of-type {
      border-bottom: none;
      margin-bottom: 0.2rem;
      padding-bottom: 0.2rem;
    }

    .tf-section-header {
      display: flex;
      align-items: baseline;
      gap: 0.4rem;
      margin-bottom: 0.25rem;
    }

    .tf-section-header h2 {
      margin: 0;
    }

    .tf-badge {
      display: inline-flex;
      align-items: center;
      padding: 0.05rem 0.4rem;
      font-size: 0.65rem;
      border-radius: 999px;
      border: 1px solid rgba(96,165,250,0.7);
      color: #bfdbfe;
      background: rgba(15,23,42,0.9);
      text-transform: uppercase;
      letter-spacing: 0.04em;
      white-space: nowrap;
    }

    .tf-tagline {
      font-size: 0.85rem;
      color: #9ca3af;
      margin: 0.35rem 0 0.5rem;
    }

    .tf-columns {
      display: grid;
      grid-template-columns: minmax(0, 1.3fr) minmax(0, 1fr);
      gap: 1.1rem;
    }

    .tf-pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      margin-top: 0.4rem;
    }

    .tf-pill {
      padding: 0.12rem 0.48rem;
      border-radius: 999px;
      font-size: 0.72rem;
      border: 1px solid rgba(156, 163, 175, 0.7);
      color: #e5e7eb;
      white-space: nowrap;
    }

    .tf-pill--primary {
      border-color: rgba(59,130,246,0.9);
      color: #dbeafe;
    }

    .tf-callout {
      font-size: 0.8rem;
      border-radius: 0.6rem;
      padding: 0.55rem 0.7rem;
      border: 1px solid rgba(59,130,246,0.8);
      background: radial-gradient(circle at top left, rgba(37,99,235,0.33), rgba(15,23,42,0.9));
      color: #e5e7eb;
      margin-top: 0.5rem;
    }

    .tf-callout strong {
      font-weight: 600;
      color: #bfdbfe;
    }

    details.tf-details {
      border-radius: 0.7rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15,23,42,0.82);
      padding: 0.5rem 0.75rem 0.6rem;
      font-size: 0.83rem;
      margin-top: 0.55rem;
    }

    details.tf-details > summary {
      cursor: pointer;
      list-style: none;
      outline: none;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    details.tf-details > summary::-webkit-details-marker {
      display: none;
    }

    .tf-summary-text {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .tf-summary-label {
      font-weight: 500;
    }

    .tf-summary-meta {
      font-size: 0.7rem;
      color: #9ca3af;
    }

    .tf-details-body {
      margin-top: 0.55rem;
      border-top: 1px dashed rgba(55, 65, 81, 0.9);
      padding-top: 0.45rem;
      display: grid;
      gap: 0.4rem;
    }

    .tf-kv {
      display: grid;
      grid-template-columns: minmax(0, 0.55fr) minmax(0, 1fr);
      gap: 0.4rem;
      font-size: 0.8rem;
    }

    .tf-kv dt {
      font-weight: 500;
      color: #d1d5db;
    }

    .tf-kv dd {
      margin: 0;
      color: #9ca3af;
    }

    .tf-code {
      margin-top: 0.4rem;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 0.78rem;
      background: #020617;
      border-radius: 0.6rem;
      padding: 0.55rem 0.65rem;
      border: 1px solid rgba(31, 41, 55, 0.9);
      overflow-x: auto;
      line-height: 1.35;
    }

    .tf-code code {
      white-space: pre;
    }

    .tf-list {
      margin: 0.35rem 0 0.2rem;
      padding-left: 1.1rem;
      font-size: 0.82rem;
    }

    .tf-list li {
      margin-bottom: 0.12rem;
    }

    .tf-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.78rem;
      margin-top: 0.45rem;
      border-radius: 0.6rem;
      overflow: hidden;
    }

    .tf-table thead {
      background: rgba(15,23,42, 0.9);
    }

    .tf-table th,
    .tf-table td {
      border: 1px solid rgba(55, 65, 81, 0.9);
      padding: 0.35rem 0.45rem;
      text-align: left;
    }

    .tf-table th {
      font-weight: 600;
      color: #e5e7eb;
    }

    .tf-table td {
      color: #d1d5db;
    }

    .tf-breadcrumb {
      font-size: 0.78rem;
      color: #9ca3af;
      margin-bottom: 0.3rem;
    }

    .tf-breadcrumb span {
      opacity: 0.9;
    }

    .tf-highlight {
      font-weight: 500;
      color: #e5e7eb;
    }

    .tf-usecase-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
      gap: 0.6rem;
      margin-top: 0.45rem;
    }

    .tf-usecase-card {
      border-radius: 0.7rem;
      border: 1px solid rgba(75, 85, 99, 0.9);
      padding: 0.5rem 0.6rem;
      font-size: 0.8rem;
      background: rgba(15,23,42,0.9);
    }

    .tf-usecase-card h3 {
      margin: 0 0 0.25rem 0;
      font-size: 0.86rem;
    }

    .tf-usecase-card p {
      margin: 0;
      color: #9ca3af;
    }

    .tf-usecase-tags {
      margin-top: 0.35rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.25rem;
    }

    .tf-usecase-tags span {
      font-size: 0.7rem;
      border-radius: 999px;
      padding: 0.05rem 0.4rem;
      border: 1px solid rgba(55, 65, 81, 0.9);
      color: #e5e7eb;
    }

    .tf-note {
      font-size: 0.76rem;
      color: #9ca3af;
      margin-top: 0.4rem;
    }

    @media (max-width: 900px) {
      .tf-layout {
        flex-direction: column;
      }
      .tf-nav {
        width: 100%;
        max-width: 100%;
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.35);
      }
    }

    @media (max-width: 700px) {
      .shell {
        padding: 1.25rem;
      }
      .card {
        padding: 1rem 1rem 1.25rem;
      }
      header {
        align-items: flex-start;
        flex-direction: column;
      }
      .footer-note {
        text-align: left;
      }
      .tf-columns {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="card">
      <header>
        <div class="title-block">
          <h1 class="page-title" contenteditable="true" spellcheck="false">Terraform Encyclopedia · Architect's Toolkit</h1>
          <div class="page-title-hint">Rename this page to match a specific cloud, app, or project.</div>
        </div>
        <button
          class="main-menu-btn"
          type="button"
          onclick="window.location.href='index.html'">
          ← Main menu
        </button>
      </header>

      <section class="workspace">
        <div class="tf-layout">
          <nav class="tf-nav">
            <h2>Terraform Encyclopedia</h2>
            <p>Language, options, patterns – grouped by what you actually use them for.</p>

            <div class="tf-nav-section-label">Core Language</div>
            <ul>
              <li><a href="#tf-overview">1. Overview & Mental Model</a></li>
              <li><a href="#tf-blocks">2. Core Blocks</a></li>
              <li><a href="#tf-meta">3. Meta-Arguments</a></li>
              <li><a href="#tf-vars">4. Variables & Types</a></li>
              <li><a href="#tf-funcs">5. Expressions & Functions</a></li>
            </ul>

            <div class="tf-nav-section-label">Architecture Use-Cases</div>
            <ul>
              <li><a href="#tf-providers">6. Providers by Domain</a></li>
              <li><a href="#tf-modules">7. Modules & Reuse</a></li>
              <li><a href="#tf-state">8. State & Backends</a></li>
              <li><a href="#tf-workflows">9. Plans, Envs, CI/CD</a></li>
              <li><a href="#tf-usecases">10. Quick Use-Case Index</a></li>
            </ul>
          </nav>

          <main class="tf-content">
            <!-- 1. OVERVIEW -->
            <section id="tf-overview" class="tf-section">
              <div class="tf-section-header">
                <h2>1. Terraform Overview & Mental Model</h2>
                <span class="tf-badge">Core</span>
              </div>
              <p class="tf-tagline">
                Terraform describes <span class="tf-highlight">desired infrastructure state</span> using HCL.
                The engine compares that desired state to real cloud state and generates a plan of actions
                (create, update, destroy) to converge the two.
              </p>

              <div class="tf-columns">
                <div>
                  <ul class="tf-list">
                    <li><strong>Configuration</strong>: HCL files – what you write.</li>
                    <li><strong>State</strong>: Snapshot of what exists in reality.</li>
                    <li><strong>Plan</strong>: Delta between config vs. state.</li>
                    <li><strong>Apply</strong>: Terraform calling provider APIs to make reality match config.</li>
                  </ul>

                  <div class="tf-pill-row">
                    <span class="tf-pill tf-pill--primary">Config = intent</span>
                    <span class="tf-pill">State = memory</span>
                    <span class="tf-pill">Providers = cloud adapters</span>
                    <span class="tf-pill">Modules = reusable blueprints</span>
                  </div>
                </div>
                <div>
                  <div class="tf-callout">
                    <strong>Architect’s angle:</strong> treat Terraform as the single
                    <em>infrastructure source of truth</em>. Your CCoE and cloud decision logic
                    live on top of this: patterns decide <em>what</em> you build, Terraform
                    decides <em>how</em> to materialize it consistently.
                  </div>
                </div>
              </div>
            </section>

            <!-- 2. CORE BLOCKS -->
            <section id="tf-blocks" class="tf-section">
              <div class="tf-section-header">
                <h2>2. Core Terraform Blocks (All Options)</h2>
                <span class="tf-badge">Language</span>
              </div>
              <p class="tf-tagline">
                Blocks are the top-level “shapes” of Terraform. Every line of HCL lives inside one of these.
              </p>

              <details class="tf-details" open>
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>terraform</code> Block</span>
                    <span class="tf-summary-meta">Core settings: required version, backends, experiments.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Global configuration, required Terraform version, required providers, backend.</dd>
                    <dt>Where</dt>
                    <dd>Typically in <code>main.tf</code> or <code>versions.tf</code> at the root of the project.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>terraform {
  required_version = "&gt;= 1.5.0"

  required_providers {
    aws = {
      source  = "hashicorp/aws"
      version = "~&gt; 5.0"
    }
  }

  backend "s3" {
    bucket         = "ccoe-terraform-state"
    key            = "networking/global.tfstate"
    region         = "us-east-1"
    dynamodb_table = "terraform-locks"
  }
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>provider</code> Block</span>
                    <span class="tf-summary-meta">Tells Terraform how to talk to a cloud/API.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Configure credentials, regions, and other provider-wide defaults.</dd>
                    <dt>Alias support</dt>
                    <dd>Use <code>alias</code> for multi-region, multi-account, or multi-cloud patterns.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>provider "aws" {
  region = "us-east-1"
}

provider "aws" {
  alias  = "central"
  region = "us-east-2"
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>resource</code> Block</span>
                    <span class="tf-summary-meta">Create/update/delete real infrastructure.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Anything that exists in the cloud: VPCs, subnets, VMs, DBs, users, policies.</dd>
                    <dt>Shape</dt>
                    <dd><code>resource "TYPE" "NAME" { ... }</code> – type from provider, name is local handle.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>resource "aws_vpc" "core" {
  cidr_block           = "10.10.0.0/16"
  enable_dns_support   = true
  enable_dns_hostnames = true

  tags = {
    Name = "ccoe-core"
  }
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>data</code> Block</span>
                    <span class="tf-summary-meta">Read-only lookup of existing things.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Query existing AMIs, VPCs, IAM roles, etc. without managing their lifecycle.</dd>
                    <dt>Pattern</dt>
                    <dd>Use data sources to avoid hard-coding IDs and to plug into existing estates.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>data "aws_ami" "latest_al2" {
  most_recent = true

  filter {
    name   = "name"
    values = ["al2023-ami-*-x86_64"]
  }

  owners = ["amazon"]
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>variable</code> Block</span>
                    <span class="tf-summary-meta">Parameters for your modules / root config.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Allow different values per environment, per workspace, or per caller module.</dd>
                    <dt>Key options</dt>
                    <dd><code>type</code>, <code>default</code>, <code>description</code>, <code>sensitive</code>, <code>nullable</code>, validation.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>variable "environment" {
  type        = string
  description = "Deployment environment (dev, test, prod)"
  default     = "dev"

  validation {
    condition     = contains(["dev", "test", "prod"], var.environment)
    error_message = "Environment must be dev, test, or prod."
  }
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>output</code> Block</span>
                    <span class="tf-summary-meta">Export values from a module / root config.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Expose connection info, IDs, or URLs to callers, CI/CD, or humans.</dd>
                    <dt>Options</dt>
                    <dd><code>sensitive</code>, <code>description</code>, <code>depends_on</code> (rarely).</dd>
                  </dl>
                  <div class="tf-code">
                    <code>output "vpc_id" {
  value       = aws_vpc.core.id
  description = "The ID of the core VPC."
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>locals</code> Block</span>
                    <span class="tf-summary-meta">Reusable computed values.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>DRYing up repeated expressions, building derived structures.</dd>
                    <dt>Access</dt>
                    <dd>Refer via <code>local.NAME</code> and <code>locals { ... }</code> scope.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>locals {
  name_prefix = "${var.environment}-core"
  az_list     = ["us-east-1a", "us-east-1b", "us-east-1c"]
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>module</code> Block</span>
                    <span class="tf-summary-meta">Reusable composition unit (your blueprints).</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Used for</dt>
                    <dd>Call other configurations, pass in variables, receive outputs.</dd>
                    <dt>Sources</dt>
                    <dd>Local path, git repo, registry (<code>app/ccoe/network/vpc</code>), archive, etc.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>module "network" {
  source      = "appcorp/landing-zone/aws"
  version     = "1.2.0"
  environment = var.environment
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>backend</code>, <code>moved</code>, <code>import</code></span>
                    <span class="tf-summary-meta">Advanced: state & refactoring.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt><code>backend</code></dt>
                    <dd>Inside <code>terraform {}</code>: configure where state lives (S3, GCS, AzureRM, etc.).</dd>
                    <dt><code>moved</code></dt>
                    <dd>Tell Terraform that a resource address changed (rename / refactors without recreation).</dd>
                    <dt><code>import</code> block</dt>
                    <dd>(Modern syntax) declarative import – map existing resources into state files.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>moved {
  from = aws_instance.web
  to   = aws_instance.frontend
}

import {
  to = aws_s3_bucket.logs
  id = "account-logs-bucket"
}</code>
                  </div>
                </div>
              </details>
            </section>

            <!-- 3. META-ARGUMENTS -->
            <section id="tf-meta" class="tf-section">
              <div class="tf-section-header">
                <h2>3. Meta-Arguments on Resources & Modules</h2>
                <span class="tf-badge">Control</span>
              </div>
              <p class="tf-tagline">
                Meta-arguments modify how a block behaves (counting, iteration, dependencies, lifecycle).
              </p>

              <table class="tf-table">
                <thead>
                  <tr>
                    <th>Meta-Argument</th>
                    <th>Applies To</th>
                    <th>Purpose</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>count</code></td>
                    <td>resource, module</td>
                    <td>Create N copies indexed by <code>count.index</code>.</td>
                  </tr>
                  <tr>
                    <td><code>for_each</code></td>
                    <td>resource, module</td>
                    <td>One instance per key/value in a map or set.</td>
                  </tr>
                  <tr>
                    <td><code>depends_on</code></td>
                    <td>resource, module, output</td>
                    <td>Force dependency when not detected automatically.</td>
                  </tr>
                  <tr>
                    <td><code>provider</code></td>
                    <td>resource, module</td>
                    <td>Override which provider alias to use.</td>
                  </tr>
                  <tr>
                    <td><code>lifecycle</code></td>
                    <td>resource</td>
                    <td>Control create/destroy semantics and drift handling.</td>
                  </tr>
                  <tr>
                    <td><code>provisioner</code></td>
                    <td>resource</td>
                    <td>Last-resort remote/local commands (generally avoided in CCoE patterns).</td>
                  </tr>
                </tbody>
              </table>

              <details class="tf-details" open>
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>count</code> vs <code>for_each</code></span>
                    <span class="tf-summary-meta">Scaling resources & modules.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <div>
                    <strong><code>count</code></strong> – good for “N identical instances”:
                    <div class="tf-code">
                      <code>resource "aws_instance" "web" {
  count         = 3
  ami           = data.aws_ami.latest_al2.id
  instance_type = "t3.micro"

  tags = {
    Name = "web-${count.index}"
  }
}</code>
                    </div>
                  </div>
                  <div>
                    <strong><code>for_each</code></strong> – good for “instances keyed by name / map key”:
                    <div class="tf-code">
                      <code>locals {
  app_servers = {
    api  = "t3.medium"
    web  = "t3.small"
    batch = "t3.large"
  }
}

resource "aws_instance" "app" {
  for_each      = local.app_servers
  ami           = data.aws_ami.latest_al2.id
  instance_type = each.value

  tags = {
    Name = each.key
  }
}</code>
                    </div>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label"><code>lifecycle</code></span>
                    <span class="tf-summary-meta">Protecting and controlling resource changes.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <ul class="tf-list">
                    <li><code>create_before_destroy</code> – ensure replacement builds first, then old destroyed.</li>
                    <li><code>prevent_destroy</code> – block destroys unless explicitly overridden.</li>
                    <li><code>ignore_changes</code> – ignore certain attributes even if drifted.</li>
                    <li><code>replace_triggered_by</code> – trigger recreation when another resource/attr changes.</li>
                  </ul>
                  <div class="tf-code">
                    <code>resource "aws_s3_bucket" "logs" {
  bucket = "${var.environment}-logs"

  lifecycle {
    prevent_destroy = true
    ignore_changes  = [tags]
  }
}</code>
                  </div>
                </div>
              </details>
            </section>

            <!-- 4. VARIABLES & TYPES -->
            <section id="tf-vars" class="tf-section">
              <div class="tf-section-header">
                <h2>4. Variables, Types & Validation</h2>
                <span class="tf-badge">Inputs</span>
              </div>
              <p class="tf-tagline">
                Variables drive environment differences. Types and validation enforce CCoE standards.
              </p>

              <div class="tf-columns">
                <div>
                  <h3>4.1 Primitive & Collection Types</h3>
                  <ul class="tf-list">
                    <li>Primitive: <code>string</code>, <code>number</code>, <code>bool</code></li>
                    <li>Collections: <code>list(T)</code>, <code>set(T)</code>, <code>map(T)</code></li>
                    <li>Structural: <code>object({ ... })</code>, <code>tuple([ ... ])</code>, <code>any</code></li>
                  </ul>
                  <div class="tf-code">
                    <code>variable "azs" {
  type        = list(string)
  description = "Availability zones to use."
}

variable "tags" {
  type        = map(string)
  description = "Common tags applied to all resources."
}</code>
                  </div>
                </div>
                <div>
                  <h3>4.2 Complex Objects & Validation</h3>
                  <div class="tf-code">
                    <code>variable "service_config" {
  type = object({
    name        = string
    port        = number
    public      = bool
    extra_tags  = optional(map(string), {})
  })
}

variable "environment" {
  type = string

  validation {
    condition     = contains(["dev", "test", "prod"], var.environment)
    error_message = "Environment must be dev, test, or prod."
  }
}</code>
                  </div>
                  <p class="tf-note">
                    Use <code>object</code> + <code>optional()</code> to define CCoE-approved shapes for apps,
                    networks, accounts, etc. Then all teams conform to one schema.
                  </p>
                </div>
              </div>
            </section>

            <!-- 5. EXPRESSIONS & FUNCTIONS -->
            <section id="tf-funcs" class="tf-section">
              <div class="tf-section-header">
                <h2>5. Expressions & Built-in Functions</h2>
                <span class="tf-badge">Logic</span>
              </div>
              <p class="tf-tagline">
                Terraform is declarative, but it still needs basic logic. Expressions and functions are
                <em>the only</em> way you should encode that logic.
              </p>

              <h3>5.1 Common Expression Patterns</h3>
              <ul class="tf-list">
                <li><strong>Conditionals</strong>: <code>condition ? true_val : false_val</code></li>
                <li><strong>For loops</strong>: <code>[for x in list : expression]</code>, <code>{for k, v in map : ...}</code></li>
                <li><strong>Dynamic blocks</strong>: generate nested blocks from collections.</li>
                <li><strong>Null</strong>: <code>null</code> means “unset / use default” in many providers.</li>
              </ul>
              <div class="tf-code">
                <code>locals {
  public_subnets = [for s in var.subnets : s if s.public]
}

resource "aws_security_group_rule" "egress_all" {
  count             = var.egress_enabled ? 1 : 0
  type              = "egress"
  from_port         = 0
  to_port           = 0
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.app.id
}</code>
              </div>

              <h3>5.2 Function Groups & Usage</h3>
              <table class="tf-table">
                <thead>
                  <tr>
                    <th>Group</th>
                    <th>Examples</th>
                    <th>What for</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>String</td>
                    <td><code>lower</code>, <code>upper</code>, <code>replace</code>, <code>format</code>, <code>split</code>, <code>join</code>, <code>trimprefix</code>, <code>trimsuffix</code>, <code>trimspace</code>, <code>substr</code></td>
                    <td>Normalize names, build tags, clean input values.</td>
                  </tr>
                  <tr>
                    <td>Number</td>
                    <td><code>abs</code>, <code>ceil</code>, <code>floor</code>, <code>max</code>, <code>min</code>, <code>parseint</code>, <code>signum</code></td>
                    <td>Index math, port ranges, scaling calculations.</td>
                  </tr>
                  <tr>
                    <td>Collection</td>
                    <td><code>length</code>, <code>contains</code>, <code>distinct</code>, <code>flatten</code>, <code>keys</code>, <code>values</code>, <code>lookup</code>, <code>merge</code>, <code>zipmap</code>, <code>sort</code>, <code>slice</code>, <code>sum</code></td>
                    <td>Build complex objects, dedupe, merge default vs. env-specific settings.</td>
                  </tr>
                  <tr>
                    <td>Encoding</td>
                    <td><code>jsonencode</code>, <code>jsondecode</code>, <code>base64encode</code>, <code>base64decode</code>, <code>urlencode</code>, <code>yamldecode</code>, <code>yamlencode</code></td>
                    <td>Policies, Kubernetes manifests, config blobs.</td>
                  </tr>
                  <tr>
                    <td>Files / Templates</td>
                    <td><code>file</code>, <code>fileexists</code>, <code>filebase64</code>, <code>templatefile</code></td>
                    <td>Render configs, scripts, cloud-init.</td>
                  </tr>
                  <tr>
                    <td>CIDR / Network</td>
                    <td><code>cidrsubnet</code>, <code>cidrsubnets</code>, <code>cidrhost</code>, <code>cidrnetmask</code></td>
                    <td>Subnets and addressing schemes from a root CIDR.</td>
                  </tr>
                  <tr>
                    <td>Crypto</td>
                    <td><code>md5</code>, <code>sha1</code>, <code>sha256</code>, <code>sha512</code>, <code>bcrypt</code></td>
                    <td>Checksum, idempotent naming, password hashes.</td>
                  </tr>
                  <tr>
                    <td>Time</td>
                    <td><code>timestamp</code>, <code>timeadd</code>, <code>formatdate</code></td>
                    <td>Expiry times, TTL windows, naming by date.</td>
                  </tr>
                  <tr>
                    <td>Error-handling</td>
                    <td><code>try</code>, <code>can</code>, <code>coalesce</code>, <code>coalescelist</code>, <code>one</code>, <code>alltrue</code>, <code>anytrue</code></td>
                    <td>Fallbacks, making modules robust to partial inputs.</td>
                  </tr>
                </tbody>
              </table>

              <p class="tf-note">
                This table groups most of the commonly used functions. In practice, you’ll only lean on
                a subset in each module – the key is to know <em>what group to reach for</em> when solving a problem.
              </p>
            </section>

            <!-- 6. PROVIDERS BY DOMAIN -->
            <section id="tf-providers" class="tf-section">
              <div class="tf-section-header">
                <h2>6. Providers Grouped by Domain</h2>
                <span class="tf-badge">Clouds & APIs</span>
              </div>
              <p class="tf-tagline">
                Providers are adapters that translate HCL into API calls. Group them by what they do
                (compute, network, IAM, storage, platform tools) for clean CCoE patterns.
              </p>

              <div class="tf-usecase-grid">
                <div class="tf-usecase-card">
                  <h3>Compute & Runtime</h3>
                  <p>AWS EC2, Azure VM, GCP Compute, Kubernetes, vSphere, ECS, EKS, AKS, GKE.</p>
                  <div class="tf-usecase-tags">
                    <span>aws</span><span>azurerm</span><span>google</span><span>kubernetes</span><span>vsphere</span>
                  </div>
                </div>
                <div class="tf-usecase-card">
                  <h3>Networking</h3>
                  <p>VPC/VNet/VPC, load balancers, DNS, CDN, firewalls, WAF.</p>
                  <div class="tf-usecase-tags">
                    <span>aws</span><span>azurerm</span><span>google</span><span>cloudflare</span>
                  </div>
                </div>
                <div class="tf-usecase-card">
                  <h3>Identity & Secrets</h3>
                  <p>IAM roles/policies, SSO, directory entries, secrets engines.</p>
                  <div class="tf-usecase-tags">
                    <span>aws</span><span>azuread</span><span>google</span><span>vault</span><span>okta</span>
                  </div>
                </div>
                <div class="tf-usecase-card">
                  <h3>Storage & Databases</h3>
                  <p>Object storage, block storage, managed DBs, caches.</p>
                  <div class="tf-usecase-tags">
                    <span>aws</span><span>azurerm</span><span>google</span><span>mongodbatlas</span><span>redis</span>
                  </div>
                </div>
                <div class="tf-usecase-card">
                  <h3>DevOps & Platform</h3>
                  <p>GitHub, GitLab, CI/CD runners, monitoring, logging.</p>
                  <div class="tf-usecase-tags">
                    <span>github</span><span>gitlab</span><span>datadog</span><span>newrelic</span>
                  </div>
                </div>
                <div class="tf-usecase-card">
                  <h3>Enterprise Integration</h3>
                  <p>Ticketing, CMDB, policy engines, FinOps, and cost tools.</p>
                  <div class="tf-usecase-tags">
                    <span>servicenow</span><span>pagerduty</span><span>azapi</span>
                  </div>
                </div>
              </div>

              <p class="tf-note">
                In your Architect’s Kit, you’ll typically preselect “blessed” providers per domain
                (e.g., <code>aws</code> + <code>azurerm</code> + <code>google</code> + <code>kubernetes</code>),
                then build modules on top so teams never interact with raw provider resources directly.
              </p>
            </section>

            <!-- 7. MODULES & REUSE -->
            <section id="tf-modules" class="tf-section">
              <div class="tf-section-header">
                <h2>7. Modules, Composition & Patterns</h2>
                <span class="tf-badge">Blueprints</span>
              </div>
              <p class="tf-tagline">
                Modules are where architecture patterns become enforceable code – landing zones, app stacks,
                shared services, everything.
              </p>

              <details class="tf-details" open>
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label">Module Types</span>
                    <span class="tf-summary-meta">Root, reusable, and external/registry.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <dl class="tf-kv">
                    <dt>Root module</dt>
                    <dd>Your top-level config in a folder (often environment-specific).</dd>
                    <dt>Child modules</dt>
                    <dd>Reusable packages for VPCs, app stacks, databases, etc.</dd>
                    <dt>Registry modules</dt>
                    <dd>Public or private registry modules, versioned and shareable.</dd>
                  </dl>
                  <div class="tf-code">
                    <code>module "vpc" {
  source  = "terraform-aws-modules/vpc/aws"
  version = "~&gt; 5.0"

  name = "${var.environment}-core"
  cidr = "10.0.0.0/16"

  azs             = local.az_list
  public_subnets  = local.public_cidrs
  private_subnets = local.private_cidrs
}</code>
                  </div>
                </div>
              </details>

              <details class="tf-details">
                <summary>
                  <div class="tf-summary-text">
                    <span class="tf-summary-label">Input/Output Contract</span>
                    <span class="tf-summary-meta">Make modules stable across environments.</span>
                  </div>
                </summary>
                <div class="tf-details-body">
                  <p class="tf-note">
                    A “good” module has a small, clear set of inputs and only exports what callers
                    truly need. This is how the CCoE enforces standards while still giving teams flexibility.
                  </p>
                  <div class="tf-code">
                    <code># In module: variables
variable "environment" { type = string }
variable "service_name" { type = string }

# In module: outputs
output "vpc_id" {
  value       = aws_vpc.core.id
  description = "VPC ID created by this module."
}

# In root module: consume
module "network" {
  source       = "../modules/network"
  environment  = var.environment
  service_name = "payments"
}

output "network_vpc_id" {
  value = module.network.vpc_id
}</code>
                  </div>
                </div>
              </details>
            </section>

            <!-- 8. STATE & BACKENDS -->
            <section id="tf-state" class="tf-section">
              <div class="tf-section-header">
                <h2>8. State Management & Backends</h2>
                <span class="tf-badge">Reality</span>
              </div>
              <p class="tf-tagline">
                State is the link between config and reality. Backends store it, locks protect it,
                and state commands help you repair / migrate it.
              </p>

              <h3>8.1 Backends (Options)</h3>
              <ul class="tf-list">
                <li><strong>local</strong> – local file on disk (lab only).</li>
                <li><strong>s3</strong> – AWS S3 bucket + DynamoDB locks.</li>
                <li><strong>azurerm</strong> – Azure storage account + blob container.</li>
                <li><strong>gcs</strong> – Google Cloud Storage bucket.</li>
                <li><strong>remote</strong> – Terraform Cloud / Enterprise.</li>
                <li><strong>consul</strong>, etcd – older patterns for key/value backends.</li>
              </ul>

              <div class="tf-code">
                <code>terraform {
  backend "s3" {
    bucket         = "ccoe-tfstate"
    key            = "landing-zone/global.tfstate"
    region         = "us-east-1"
    dynamodb_table = "tf-locks"
    encrypt        = true
  }
}</code>
              </div>

              <h3>8.2 State Commands</h3>
              <table class="tf-table">
                <thead>
                  <tr>
                    <th>Command</th>
                    <th>Purpose</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>terraform state list</code></td>
                    <td>Show all objects in current state file.</td>
                  </tr>
                  <tr>
                    <td><code>terraform state show &lt;addr&gt;</code></td>
                    <td>Inspect a specific resource’s state.</td>
                  </tr>
                  <tr>
                    <td><code>terraform state mv</code></td>
                    <td>Move an address (e.g., after refactors) without recreating.</td>
                  </tr>
                  <tr>
                    <td><code>terraform state rm</code></td>
                    <td>Detach from Terraform (resource stays live in cloud).</td>
                  </tr>
                  <tr>
                    <td><code>terraform import</code></td>
                    <td>Attach an existing resource into state.</td>
                  </tr>
                </tbody>
              </table>
            </section>

            <!-- 9. WORKFLOWS -->
            <section id="tf-workflows" class="tf-section">
              <div class="tf-section-header">
                <h2>9. Workflows, Environments & CI/CD</h2>
                <span class="tf-badge">Lifecycle</span>
              </div>
              <p class="tf-tagline">
                The same language options behave differently when wrapped in different workflows.
                CCoE defines the “golden path” so teams don’t invent their own.
              </p>

              <div class="tf-columns">
                <div>
                  <h3>9.1 Core Commands</h3>
                  <ul class="tf-list">
                    <li><code>terraform init</code> – install providers, configure backend.</li>
                    <li><code>terraform validate</code> – syntax and static checks.</li>
                    <li><code>terraform plan</code> – diff between desired vs. current.</li>
                    <li><code>terraform apply</code> – execute plan.</li>
                    <li><code>terraform destroy</code> – tear everything down.</li>
                  </ul>
                  <div class="tf-code">
                    <code># Typical pipeline skeleton
terraform fmt       # normalize style
terraform validate  # static checks
terraform plan -out plan.bin
terraform apply plan.bin</code>
                  </div>
                </div>
                <div>
                  <h3>9.2 Environments & Workspaces</h3>
                  <ul class="tf-list">
                    <li><strong>Pattern 1:</strong> separate folders/repos per env (<code>envs/dev</code>, <code>envs/prod</code>).</li>
                    <li><strong>Pattern 2:</strong> workspaces per env (<code>terraform workspace new dev</code>).</li>
                  </ul>
                  <p class="tf-note">
                    CCoE usually standardizes one approach (e.g., separate state per env with
                    explicit backend config) and documents the pattern in this toolkit.
                  </p>
                </div>
              </div>
            </section>

            <!-- 10. QUICK USE-CASE INDEX -->
            <section id="tf-usecases" class="tf-section">
              <div class="tf-section-header">
                <h2>10. Quick Use-Case Index (What to Use for What)</h2>
                <span class="tf-badge">Cheat Sheet</span>
              </div>
              <p class="tf-tagline">
                Map real-world tasks to Terraform language options. This is the “decision logic” view.
              </p>

              <table class="tf-table">
                <thead>
                  <tr>
                    <th>Task</th>
                    <th>Core Blocks / Options</th>
                    <th>Typical Functions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Create secure multi-AZ VPC</td>
                    <td><code>resource</code> VPC/subnets, <code>module</code> VPC, <code>for_each</code>, <code>locals</code></td>
                    <td><code>cidrsubnet</code>, <code>cidrhost</code>, <code>merge</code>, <code>length</code></td>
                  </tr>
                  <tr>
                    <td>Standardized app stack</td>
                    <td><code>module</code> app, <code>variable</code> objects, <code>output</code> endpoints</td>
                    <td><code>format</code>, <code>join</code>, <code>lookup</code>, <code>try</code></td>
                  </tr>
                  <tr>
                    <td>Account / subscription bootstrap</td>
                    <td><code>module</code> landing zone, IAM resources, <code>for_each</code> across accounts</td>
                    <td><code>zipmap</code>, <code>keys</code>, <code>values</code></td>
                  </tr>
                  <tr>
                    <td>Multi-cloud pattern</td>
                    <td><code>provider</code> aliases, conditional <code>resource</code> blocks, shared <code>module</code> interface</td>
                    <td><code>coalesce</code>, <code>try</code>, <code>can</code></td>
                  </tr>
                  <tr>
                    <td>Policy & config blobs</td>
                    <td>IAM/KMS resources, <code>locals</code>, <code>variable</code> objects</td>
                    <td><code>jsonencode</code>, <code>templatefile</code>, <code>yamldecode</code></td>
                  </tr>
                  <tr>
                    <td>Onboarding new app team</td>
                    <td>Standard <code>module</code> suite, prewired providers, constrained variables</td>
                    <td><code>contains</code>, <code>alltrue</code>, <code>anytrue</code></td>
                  </tr>
                </tbody>
              </table>

              <p class="tf-note">
                Extend this table with your own patterns (e.g., “court-to-court secure link”,
                “L5/L6 isolated zone”, “CJIS-compliant data enclave”) and tie each to modules,
                providers, and meta-arguments in this encyclopedia.
              </p>
            </section>
          </main>
        </div>
      </section>

      <div class="footer-note">
        Terraform reference page for the Architect's Toolkit. Extend sections or link into cloud-specific playbooks.
      </div>
    </div>
  </div>
</body>
</html>
